#!/usr/bin/sh
# @author nate zhou
# @since 2025
# file opener ported from my [lf](../../.config/lf/rifle)

file="$1"

print_err() {
    local RED='\033[0;31m'
    local RESET='\033[0m'
    printf ${RED}"${1}"${RESET}\\n
}

[ -z "$1" ] && print_err "No file specified." && exit 1

case $(file --mime-type -Lb $file) in
    image/x-xcf)
        gimp "$file"
        ;;
    image/*)
        [ "$XDG_SESSION_TYPE" = "tty" ] \
            && mpv --loop "$file" \
            || swayimg "$file"
        ;;
    video/*)
        mpv --loop "$file"
        ;;
    audio/*)
        [ "$XDG_SESSION_TYPE" != "tty" ] && term="footclient"
        "$term" mpv --loop "$file"
        ;;
    */pdf|*/epub*)
        zathura "$file"
        ;;
	application/*opendocument*|*officedocument*)
        libreoffice "$file"
        ;;
    text/html)
        case "$f" in
            *.md)
                $EDITOR "$file"
                ;;
            *)
                [ "$XDG_SESSION_TYPE" != "tty" ] && $BROWSER "$file" || w3m "$file"
                ;;
        esac
        ;;
    text/*|*/json|inode/x-empty|application/javascript)
        $EDITOR "$file"
        ;;
    application/*)
        ${HOME}/.local/bin/scope "$file"
        ;;
    *)
        print_err "[$(basename $0)]: file type not supported."
        file --mime-type "$file"
        ;;
esac
