#!/usr/bin/sh
# @author nate zhou
# @since 2025,2026
# @depends wl-clipboard qrtool swayimg
# convert current clipboard object to qrcode

qrcode="${XDG_RUNTIME_DIR}/clip-qrcode.png"

if [ "$XDG_SESSION_TYPE" = "wayland" ]; then
    clipboard="wl-paste"
    viewer="swayimg --class=Floating_IMG"
elif [ -n "$XAUTHORITY" ]; then
    clipboard="xsel --clipboard --output"
    viewer="nsxiv -N Floating_IMG --no-bar --private"
fi


$clipboard | qrtool encode > "$qrcode"

$viewer "$qrcode"
