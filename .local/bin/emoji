#!/usr/bin/sh
# @author nate zhou
# @since 2025,2026
# emoji selector

EMOJI_CACHE="${HOME}/.local/share/emoji-test.txt"
EMOJI_REMOTE="https://unicode.org/Public/emoji/latest/emoji-test.txt"

if [ "$XDG_SESSION_TYPE" = "wayland" ]; then
    menu="wmenu-color"
    clipboard="wl-copy"
elif [ -n "$XAUTHORITY" ]; then
    menu="dmenu"
    clipboard="xsel -b"
fi

[ -f "$EMOJI_CACHE" ] || curl "$EMOJI_REMOTE" > "$EMOJI_CACHE"


cut -d'#' -f2- "$EMOJI_CACHE" | sed '0,/group:/{//!d;}; /^\s*$/d' \
                              | $menu  -i -l 9 -p "$(basename $0)" \
                              | cut -d' ' -f2 \
                              | $clipboard
